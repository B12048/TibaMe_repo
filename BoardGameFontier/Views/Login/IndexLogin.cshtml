@model LoginViewModel

@{
    ViewData["Title"] = "會員登入";
    Layout = "~/Views/Shared/_Layout.cshtml"; // 若沒用 Layout 可移除這行
    ViewBag.HideHeaderFooter = true;
}


<div class="container d-flex align-items-center justify-content-center min-vh-100">
    <div class="card p-4 shadow" style="width: 100%; max-width: 400px;">
        <h2 class="text-center mb-4">會員登入</h2>
       
        @*  顯示錯誤訊息區塊  *@
        @if (!ViewData.ModelState.IsValid)
        {
            <div class="alert alert-danger">
                @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
                {
                    <div>@error.ErrorMessage</div>
                }
            </div>
        }

        <form asp-action="IndexLogin" method="post">
            @Html.AntiForgeryToken() <!--防CSRF攻擊-->
            @if (!string.IsNullOrEmpty(ViewBag.ReturnUrl))
            {
                <input type="hidden" name="returnUrl" value="@ViewBag.ReturnUrl" />
            }
            <div class="mb-3">
                <input type="text" class="form-control" name="UserName" placeholder="您的Email帳號" required />
               @*  @Html.ValidationMessageFor(m => m.UserName, "", new { @class = "text-danger" }) *@
            </div>

            <div class="mb-1">
                <input type="password" class="form-control" name="Password" placeholder="密碼" required />
               @*  @Html.ValidationMessageFor(m => m.Password, "", new { @class = "text-danger" }) *@
            </div>

            <div class="text-end mb-3">
                <a asp-action="ForgotPwd" class="text-primary text-decoration-none" style="font-size: 0.875rem;">忘記密碼</a>
            </div>

            <div class="form-check mb-2">
                <!--↓改了強型別寫法處理勾選Bug-->
                @Html.CheckBoxFor(m => m.RememberMe, new { @class = "form-check-input", id = "RememberMe" })
                <label class="form-check-label" for="RememberMe">記住我</label>
            </div>

            <button type="submit" class="btn btn-success w-100 mb-3">登入</button>
        </form>

        <div class="text-center text-muted mb-3">
            我沒有帳號 → <a asp-action="Register">我要註冊</a>
        </div>
        <div class=" d-flex justify-content-center">
            <a href="/" class="btn btn-outline-success" style="border-radius: 2rem;">
                <i class="fa-solid fa-house-chimney"></i> 回首頁
            </a>
        </div>

        <hr>

        <div class="d-flex justify-content-center gap-3">
            <!--這一塊可能未來有機會再寫，沒有時間的話就拿掉-->
            <a href="@Url.Action("GoogleLogin", "ExternalLogin")" class="rounded-circle bg-danger text-white d-flex justify-content-center align-items-center" style="width:40px; height:40px; text-decoration:none;">G</a>
            <a href="@Url.Action("FacebookLogin", "ExternalLogin")" class="rounded-circle bg-primary text-white d-flex justify-content-center align-items-center" style="width:40px; height:40px; text-decoration:none;">f</a>
        </div>
    </div>
</div>
@section Scripts {
    <script>
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get("locked") === "true") {
            alert("違規次數超過，帳號已被鎖定");
        }
    </script>
}

